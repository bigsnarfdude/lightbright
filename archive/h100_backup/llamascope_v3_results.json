{
  "config": {
    "max_seq_len": 512,
    "batch_size": 16,
    "n_folds": 3,
    "n_seeds": 3,
    "svd_components": 500,
    "max_train_per_class": 1000,
    "layers_to_test": [
      0,
      4,
      8,
      12,
      16,
      20,
      24,
      28
    ],
    "sae_release": "llama_scope_lxm_32x",
    "base_model": "meta-llama/Llama-3.1-8B",
    "trained_model": "vincentoh/llama-8b-af-detector"
  },
  "timestamp": "2026-01-05T18:18:12.728016",
  "experiments": {
    "l0_base_logreg": {
      "layer": 0,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.9477506313563929,
        "s": 0.0008805120827127244
      },
      "eval_auroc": {
        "m": 0.6787878787878787,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.6415094339622641,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.5476190476190477,
        "s": 0.0
      }
    },
    "l0_base_rf": {
      "layer": 0,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.927090571417533,
        "s": 0.002797856058939893
      },
      "eval_auroc": {
        "m": 0.6625074272133096,
        "s": 0.012038209161857742
      },
      "eval_acc": {
        "m": 0.6163522012578616,
        "s": 0.008894424920585502
      },
      "eval_f1": {
        "m": 0.4739091318038687,
        "s": 0.018767116549710458
      }
    },
    "l0_trained_logreg": {
      "layer": 0,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.9490850323569271,
        "s": 0.00041861092097089214
      },
      "eval_auroc": {
        "m": 0.6884135472370767,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.6037735849056604,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.47500000000000003,
        "s": 0.0
      }
    },
    "l0_trained_rf": {
      "layer": 0,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.9330136301748633,
        "s": 0.002096483011230386
      },
      "eval_auroc": {
        "m": 0.6381461675579322,
        "s": 0.003148577848958262
      },
      "eval_acc": {
        "m": 0.6132075471698113,
        "s": 0.013341637380878252
      },
      "eval_f1": {
        "m": 0.484584521169887,
        "s": 0.03082869761438858
      }
    },
    "l4_base_logreg": {
      "layer": 4,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.919069084369115,
        "s": 0.000541980009925067
      },
      "eval_auroc": {
        "m": 0.5946524064171123,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5660377358490566,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.48888888888888893,
        "s": 0.0
      }
    },
    "l4_base_rf": {
      "layer": 4,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.9211323930549145,
        "s": 0.0018869414238359469
      },
      "eval_auroc": {
        "m": 0.6003565062388593,
        "s": 0.0029072203975578957
      },
      "eval_acc": {
        "m": 0.5754716981132075,
        "s": 0.013341637380878252
      },
      "eval_f1": {
        "m": 0.4398774585521574,
        "s": 0.007211956803790892
      }
    },
    "l4_trained_logreg": {
      "layer": 4,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8981867867639868,
        "s": 0.00046817168469661194
      },
      "eval_auroc": {
        "m": 0.6106951871657753,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5754716981132075,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.4578313253012048,
        "s": 0.0
      }
    },
    "l4_trained_rf": {
      "layer": 4,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.904070345902897,
        "s": 0.0008266757678690524
      },
      "eval_auroc": {
        "m": 0.5941176470588235,
        "s": 0.009290847160494366
      },
      "eval_acc": {
        "m": 0.5754716981132075,
        "s": 0.007702797933280433
      },
      "eval_f1": {
        "m": 0.5654447439353101,
        "s": 0.018814608279800374
      }
    },
    "l8_base_logreg": {
      "layer": 8,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.7108784547136072,
        "s": 0.0013844448423651979
      },
      "eval_auroc": {
        "m": 0.6559714795008913,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5566037735849056,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.6618705035971223,
        "s": 0.0
      }
    },
    "l8_base_rf": {
      "layer": 8,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.7149181423245907,
        "s": 0.0011795788097473082
      },
      "eval_auroc": {
        "m": 0.6141414141414142,
        "s": 0.008236160044467178
      },
      "eval_acc": {
        "m": 0.4905660377358491,
        "s": 5.551115123125783e-17
      },
      "eval_f1": {
        "m": 0.64,
        "s": 0.0
      }
    },
    "l8_trained_logreg": {
      "layer": 8,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.7411964361069154,
        "s": 0.008499988024741693
      },
      "eval_auroc": {
        "m": 0.6306595365418894,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5283018867924528,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.647887323943662,
        "s": 0.0
      }
    },
    "l8_trained_rf": {
      "layer": 8,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.7364829524758916,
        "s": 0.0021995293563793973
      },
      "eval_auroc": {
        "m": 0.6281639928698753,
        "s": 0.012840000020918833
      },
      "eval_acc": {
        "m": 0.5377358490566038,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.652482269503546,
        "s": 0.0
      }
    },
    "l12_base_logreg": {
      "layer": 12,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8654299825590877,
        "s": 0.0012338616924412891
      },
      "eval_auroc": {
        "m": 0.5522281639928699,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5377358490566038,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.6423357664233577,
        "s": 0.0
      }
    },
    "l12_base_rf": {
      "layer": 12,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.8572059319033839,
        "s": 0.0008144711544736452
      },
      "eval_auroc": {
        "m": 0.5462269756387403,
        "s": 0.0060925607788989205
      },
      "eval_acc": {
        "m": 0.5377358490566038,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.6423357664233577,
        "s": 0.0
      }
    },
    "l12_trained_logreg": {
      "layer": 12,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8053735480098969,
        "s": 0.0007694556879685601
      },
      "eval_auroc": {
        "m": 0.5240641711229945,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.4905660377358491,
        "s": 5.551115123125783e-17
      },
      "eval_f1": {
        "m": 0.5846153846153846,
        "s": 0.0
      }
    },
    "l12_trained_rf": {
      "layer": 12,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.8198238263318314,
        "s": 0.0006949734479515475
      },
      "eval_auroc": {
        "m": 0.4809269162210339,
        "s": 0.00934540606642799
      },
      "eval_acc": {
        "m": 0.4842767295597484,
        "s": 0.004447212460292751
      },
      "eval_f1": {
        "m": 0.6238387655487325,
        "s": 0.004453514603599707
      }
    },
    "l16_base_logreg": {
      "layer": 16,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.9376967267147865,
        "s": 0.0035454260530497655
      },
      "eval_auroc": {
        "m": 0.5019607843137255,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5377358490566038,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.4615384615384615,
        "s": 5.551115123125783e-17
      }
    },
    "l16_base_rf": {
      "layer": 16,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.9458355141148713,
        "s": 0.0004650454177947706
      },
      "eval_auroc": {
        "m": 0.49560308972073686,
        "s": 0.008202656881680518
      },
      "eval_acc": {
        "m": 0.48742138364779874,
        "s": 0.019384949694870993
      },
      "eval_f1": {
        "m": 0.2623844623844624,
        "s": 0.005676037324997708
      }
    },
    "l16_trained_logreg": {
      "layer": 16,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8457986407043249,
        "s": 0.00029531204706823824
      },
      "eval_auroc": {
        "m": 0.5418894830659536,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5377358490566038,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.449438202247191,
        "s": 0.0
      }
    },
    "l16_trained_rf": {
      "layer": 16,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.8853342052319473,
        "s": 0.0009474710485987209
      },
      "eval_auroc": {
        "m": 0.5244800950683304,
        "s": 0.0007179468790014625
      },
      "eval_acc": {
        "m": 0.5408805031446541,
        "s": 0.008894424920585502
      },
      "eval_f1": {
        "m": 0.603208179093954,
        "s": 0.009580594564922395
      }
    },
    "l20_base_logreg": {
      "layer": 20,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8339781312664375,
        "s": 0.0006542810201986588
      },
      "eval_auroc": {
        "m": 0.5283422459893048,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5660377358490566,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.3428571428571428,
        "s": 5.551115123125783e-17
      }
    },
    "l20_base_rf": {
      "layer": 20,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.8364746562510194,
        "s": 0.002620689222124531
      },
      "eval_auroc": {
        "m": 0.542602495543672,
        "s": 0.0006344075016060918
      },
      "eval_acc": {
        "m": 0.5943396226415094,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.3582089552238805,
        "s": 0.0
      }
    },
    "l20_trained_logreg": {
      "layer": 20,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8555882730536425,
        "s": 0.0017912394693353011
      },
      "eval_auroc": {
        "m": 0.5235294117647059,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5471698113207547,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.4146341463414634,
        "s": 0.0
      }
    },
    "l20_trained_rf": {
      "layer": 20,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.8503955934859891,
        "s": 0.0017975561952682105
      },
      "eval_auroc": {
        "m": 0.5239453357100415,
        "s": 0.0014937379786068242
      },
      "eval_acc": {
        "m": 0.5251572327044025,
        "s": 0.004447212460292751
      },
      "eval_f1": {
        "m": 0.3935159919585427,
        "s": 0.008180443801459984
      }
    },
    "l24_base_logreg": {
      "layer": 24,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8469039010178951,
        "s": 0.0002663381947407901
      },
      "eval_auroc": {
        "m": 0.45525846702317296,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.5094339622641509,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.2571428571428572,
        "s": 0.0
      }
    },
    "l24_base_rf": {
      "layer": 24,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.847283717156584,
        "s": 0.0009183312576958363
      },
      "eval_auroc": {
        "m": 0.50291146761735,
        "s": 0.022944314883535433
      },
      "eval_acc": {
        "m": 0.5125786163522013,
        "s": 0.004447212460292751
      },
      "eval_f1": {
        "m": 0.24381926683716962,
        "s": 0.012056381605908738
      }
    },
    "l24_trained_logreg": {
      "layer": 24,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8694680936653448,
        "s": 8.150371607789978e-05
      },
      "eval_auroc": {
        "m": 0.43636363636363634,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.42452830188679247,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.5793103448275861,
        "s": 0.0
      }
    },
    "l24_trained_rf": {
      "layer": 24,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.9287075507652371,
        "s": 0.00023029219720575015
      },
      "eval_auroc": {
        "m": 0.44367201426024955,
        "s": 0.0007701414971370453
      },
      "eval_acc": {
        "m": 0.45283018867924535,
        "s": 5.551115123125783e-17
      },
      "eval_f1": {
        "m": 0.6115915915915915,
        "s": 0.002463194793322535
      }
    },
    "l28_base_logreg": {
      "layer": 28,
      "model": "base",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8366220331928554,
        "s": 0.00043538359969964017
      },
      "eval_auroc": {
        "m": 0.4342245989304813,
        "s": 0.0
      },
      "eval_acc": {
        "m": 0.4811320754716981,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.17910447761194026,
        "s": 0.0
      }
    },
    "l28_base_rf": {
      "layer": 28,
      "model": "base",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.8748628673388762,
        "s": 0.0028045667311019195
      },
      "eval_auroc": {
        "m": 0.5013666072489602,
        "s": 0.004732574629052848
      },
      "eval_acc": {
        "m": 0.5220125786163522,
        "s": 0.004447212460292751
      },
      "eval_f1": {
        "m": 0.47941398521295425,
        "s": 0.0043398079989986895
      }
    },
    "l28_trained_logreg": {
      "layer": 28,
      "model": "trained",
      "clf": "logreg",
      "cv_auroc": {
        "m": 0.8942433619415991,
        "s": 0.00015963575530973854
      },
      "eval_auroc": {
        "m": 0.42174688057040993,
        "s": 5.551115123125783e-17
      },
      "eval_acc": {
        "m": 0.44339622641509435,
        "s": 0.0
      },
      "eval_f1": {
        "m": 0.5426356589147288,
        "s": 0.0
      }
    },
    "l28_trained_rf": {
      "layer": 28,
      "model": "trained",
      "clf": "rf",
      "cv_auroc": {
        "m": 0.902299848594946,
        "s": 0.0013953650676710996
      },
      "eval_auroc": {
        "m": 0.4727272727272727,
        "s": 0.00448357682232046
      },
      "eval_acc": {
        "m": 0.4842767295597484,
        "s": 0.004447212460292751
      },
      "eval_f1": {
        "m": 0.6221264367816092,
        "s": 0.002031916037892369
      }
    }
  },
  "best_base": {
    "layer": 0,
    "model": "base",
    "clf": "logreg",
    "cv_auroc": {
      "m": 0.9477506313563929,
      "s": 0.0008805120827127244
    },
    "eval_auroc": {
      "m": 0.6787878787878787,
      "s": 0.0
    },
    "eval_acc": {
      "m": 0.6415094339622641,
      "s": 0.0
    },
    "eval_f1": {
      "m": 0.5476190476190477,
      "s": 0.0
    }
  },
  "best_trained": {
    "layer": 0,
    "model": "trained",
    "clf": "logreg",
    "cv_auroc": {
      "m": 0.9490850323569271,
      "s": 0.00041861092097089214
    },
    "eval_auroc": {
      "m": 0.6884135472370767,
      "s": 0.0
    },
    "eval_acc": {
      "m": 0.6037735849056604,
      "s": 0.0
    },
    "eval_f1": {
      "m": 0.47500000000000003,
      "s": 0.0
    }
  },
  "stats": {
    "mean_diff": -0.011475044563279888,
    "std_diff": 0.027852171716905374,
    "t_p": 0.1314130470441713,
    "w_p": 0.17535400390625,
    "cohens_d": -0.4119981981984875,
    "n": 16,
    "comparisons": [
      {
        "layer": 0,
        "clf": "logreg",
        "base": 0.6787878787878787,
        "trained": 0.6884135472370767,
        "diff": 0.009625668449197988
      },
      {
        "layer": 0,
        "clf": "rf",
        "base": 0.6625074272133096,
        "trained": 0.6381461675579322,
        "diff": -0.024361259655377387
      },
      {
        "layer": 4,
        "clf": "logreg",
        "base": 0.5946524064171123,
        "trained": 0.6106951871657753,
        "diff": 0.016042780748663055
      },
      {
        "layer": 4,
        "clf": "rf",
        "base": 0.6003565062388593,
        "trained": 0.5941176470588235,
        "diff": -0.00623885918003575
      },
      {
        "layer": 8,
        "clf": "logreg",
        "base": 0.6559714795008913,
        "trained": 0.6306595365418894,
        "diff": -0.025311942959001854
      },
      {
        "layer": 8,
        "clf": "rf",
        "base": 0.6141414141414142,
        "trained": 0.6281639928698753,
        "diff": 0.014022578728461133
      },
      {
        "layer": 12,
        "clf": "logreg",
        "base": 0.5522281639928699,
        "trained": 0.5240641711229945,
        "diff": -0.028163992869875365
      },
      {
        "layer": 12,
        "clf": "rf",
        "base": 0.5462269756387403,
        "trained": 0.4809269162210339,
        "diff": -0.06530005941770645
      },
      {
        "layer": 16,
        "clf": "logreg",
        "base": 0.5019607843137255,
        "trained": 0.5418894830659536,
        "diff": 0.03992869875222815
      },
      {
        "layer": 16,
        "clf": "rf",
        "base": 0.49560308972073686,
        "trained": 0.5244800950683304,
        "diff": 0.02887700534759352
      },
      {
        "layer": 20,
        "clf": "logreg",
        "base": 0.5283422459893048,
        "trained": 0.5235294117647059,
        "diff": -0.004812834224598883
      },
      {
        "layer": 20,
        "clf": "rf",
        "base": 0.542602495543672,
        "trained": 0.5239453357100415,
        "diff": -0.018657159833630477
      },
      {
        "layer": 24,
        "clf": "logreg",
        "base": 0.45525846702317296,
        "trained": 0.43636363636363634,
        "diff": -0.01889483065953662
      },
      {
        "layer": 24,
        "clf": "rf",
        "base": 0.50291146761735,
        "trained": 0.44367201426024955,
        "diff": -0.0592394533571004
      },
      {
        "layer": 28,
        "clf": "logreg",
        "base": 0.4342245989304813,
        "trained": 0.42174688057040993,
        "diff": -0.012477718360071388
      },
      {
        "layer": 28,
        "clf": "rf",
        "base": 0.5013666072489602,
        "trained": 0.4727272727272727,
        "diff": -0.028639334521687487
      }
    ]
  }
}